Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/15 [00:00<00:09,  1.48it/s]Loading checkpoint shards:  13%|█▎        | 2/15 [00:01<00:08,  1.55it/s]Loading checkpoint shards:  20%|██        | 3/15 [00:02<00:08,  1.47it/s]Loading checkpoint shards:  27%|██▋       | 4/15 [00:02<00:07,  1.45it/s]Loading checkpoint shards:  33%|███▎      | 5/15 [00:03<00:07,  1.43it/s]Loading checkpoint shards:  40%|████      | 6/15 [00:04<00:06,  1.47it/s]Loading checkpoint shards:  47%|████▋     | 7/15 [00:08<00:14,  1.76s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [00:11<00:16,  2.40s/it]Loading checkpoint shards:  60%|██████    | 9/15 [00:12<00:11,  1.88s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [00:16<00:12,  2.46s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [00:17<00:08,  2.00s/it]Loading checkpoint shards:  80%|████████  | 12/15 [00:24<00:10,  3.55s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [00:28<00:07,  3.71s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [00:29<00:02,  2.81s/it]Loading checkpoint shards: 100%|██████████| 15/15 [00:29<00:00,  2.00s/it]Loading checkpoint shards: 100%|██████████| 15/15 [00:29<00:00,  1.95s/it]
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/15 [00:03<00:42,  3.07s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:05<00:37,  2.89s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:08<00:34,  2.85s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:11<00:30,  2.73s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:14<00:29,  2.90s/it]Loading checkpoint shards:  40%|████      | 6/15 [00:17<00:26,  2.94s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [00:20<00:23,  2.92s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [00:23<00:20,  2.97s/it]Loading checkpoint shards:  60%|██████    | 9/15 [00:29<00:23,  3.97s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [00:36<00:24,  4.97s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [00:41<00:19,  4.88s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [00:41<00:15,  3.81s/it]
Traceback (most recent call last):
  File "/home/bingxing2/ailab/wangkuncan/soft/l1/IntegratedCode.py", line 87, in <module>
    ref_model = AutoModelForCausalLM.from_pretrained(model_name_or_path)
  File "/home/bingxing2/ailab/wangkuncan/.conda/envs/setup/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
  File "/home/bingxing2/ailab/wangkuncan/.conda/envs/setup/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3916, in from_pretrained
    ) = cls._load_pretrained_model(
  File "/home/bingxing2/ailab/wangkuncan/.conda/envs/setup/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4370, in _load_pretrained_model
    state_dict = load_state_dict(shard_file, is_quantized=is_quantized)
  File "/home/bingxing2/ailab/wangkuncan/.conda/envs/setup/lib/python3.10/site-packages/transformers/modeling_utils.py", line 549, in load_state_dict
    with safe_open(checkpoint_file, framework="pt") as f:
RuntimeError: unable to mmap 9798066064 bytes from file </home/bingxing2/ailab/wangkuncan/.cache/huggingface/hub/models--meta-llama--Llama-2-70b-hf/snapshots/3aba440b59558f995867ba6e1f58f21d0336b5bb/model-00012-of-00015.safetensors>: Cannot allocate memory (12)
